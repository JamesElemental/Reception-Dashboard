- name: Take screenshot (no heredocs, no redirects)
        shell: bash
        run: |
          TS=$(date +"%Y%m%d-%H%M")

          node -e "
          const { chromium } = require('playwright');
          (async () => {
            const t = process.env.TS;

            const browser = await chromium.launch({
              headless: true,
              args: ['--no-sandbox']
            });

            // Zoom-out (pushed back, wider)
            const page = await browser.newPage({
              viewport: { width: 1920, height: 1000 },
              deviceScaleFactor: 2
            });

            await page.goto(
              'https://app.powerbi.com/view?r=eyJrIjoiY2E0NzNjOTktYzkxZC00N2NhLWJlY2YtMDgwNTFmZjUyOGNjIiwidCI6ImYxZDhiY2I0LTdlYTgtNDcxNC1iYmYzLTlhMzg5NzY0ZjM1MCJ9',
              { waitUntil: 'networkidle' }
            );

            await page.waitForTimeout(12000);

            const filename = 'dashboard-' + t + '.png';
            await page.screenshot({ path: filename, fullPage: false });

            console.log('Saved:', filename);
            await browser.close();
          })();
          " TS=$TS

          mkdir -p screenshots
          mv "dashboard-$TS.png" "screenshots/dashboard-$TS.png"
          cp "screenshots/dashboard-$TS.png" "screenshots/dashboard-latest.png"
          echo "dashboard-$TS.png" > screenshots/latest.txt
